source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
?define_extract_cps
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
View(data)
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
summary(data$WHYMOVE)
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
hist(data$WHYMOVE)
# remove rows where WHYMOVE is 0
data_movers_only <- data[data$WHYMOVE != 0, ]
hist(data_movers_only$WHYMOVE)
summary(data_movers_only$WHYMOVE)
View(data_movers_only)
# remove rows where WHYMOVE is 0 and MIGSTA1 is not 91 and 99
data_movers_only <- data %>%
filter(WHYMOVE != 0) %>%
filter(MIGSTA1 == 91 | MIGSTA1 == 99)
# remove rows where WHYMOVE is 0 and MIGSTA1 is not 91 and 99
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(MIGSTA1 == 91 | MIGSTA1 == 99)
library(tidyverse)
# remove rows where WHYMOVE is 0 and MIGSTA1 is not 91 and 99
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(MIGSTA1 == 91 | MIGSTA1 == 99)
hist(data_movers_only$WHYMOVE)
# remove rows where WHYMOVE is 0 and MIGSTA1 is not 91 or 99
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(!(MIGSTA1 == 91 | MIGSTA1 == 99))
hist(data_movers_only$WHYMOVE)
# filter for MIGSTA1 == 1 and WHYMOVE == 1
# MIGSTA1 == 1 is the state code for Alabama
# WHYMOVE == 1 is the reason code for job
data_movers_only |>
filter(MIGSTA1 == 1) |>
filter(WHYMOVE == 1)
View(data_movers_only |>
filter(MIGSTA1 == 1) |>
filter(WHYMOVE == 1))
hist(data$WHYMOVE)
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
source("~/GitHub/real-estate-project/reason_for_moving_data_sourcing.R", echo=TRUE)
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_histogram() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
# remove rows where WHYMOVE is 0
# and MIGSTA1 is not 91 or 99
# delete columns that are not WHYMOVE and MIGSTA1
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(!(MIGSTA1 == 91 | MIGSTA1 == 99)) |>
select(WHYMOVE, MIGSTA1)
table(data_movers_only$WHYMOVE)
# table aggregate by 2022 only
table(data_movers_only$WHYMOVE, data_movers_only$MIGSTA1)
# remove rows where WHYMOVE is 0
# and MIGSTA1 is not 91 or 99
# delete columns that are not WHYMOVE and MIGSTA1
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(!(MIGSTA1 == 91 | MIGSTA1 == 99)) |>
select(YEAR, WHYMOVE, MIGSTA1)
# table aggregate by 2022 only
table(data_movers_only[data_movers_only$YEAR == 2022, ]$WHYMOVE)
# now create proportion table
prop.table(table(data_movers_only[data_movers_only$YEAR == 2022, ]$WHYMOVE))
# now create proportion table
prop.table(table(data_movers_only$WHYMOVE))
# plot proportion table
prop.table(table(data_movers_only$WHYMOVE)) |>
as.data.frame() |>
ggplot(aes(x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Proportion")
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
library(ipumsr)
library(tidyverse)
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
# now create proportion table
prop.table(table(data_movers_only$WHYMOVE))
# now create proportion table
prop.table(table(data_movers_only$WHYMOVE)) * 100
# plot WHYMOVE by MIGSTA1
ggplot(data_movers_only, aes(x = WHYMOVE, fill = factor(MIGSTA1))) +
geom_bar(position = "fill") +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Proportion") +
scale_fill_discrete(name = "State Code",
labels = c("Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "District of Columbia", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Lousiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Puerto Rico", "Rhode Island", "South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont", "Virgin Islands", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming"))
# plot WHYMOVE by MIGSTA1
ggplot(data_movers_only, aes(x = WHYMOVE, fill = factor(MIGSTA1))) +
geom_bar(position = "fill") +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Proportion") +
scale_fill_discrete(name = "State Code",
labels = c("Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "District of Columbia", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Lousiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Puerto Rico", "Rhode Island", "South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont", "Virgin Islands", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming"))
unique(data$WHYMOVE)
unique(data$MIGSTA1)
# Assuming your dataset is named 'data'
data_movers_only$WHYMOVE <- factor(data_movers_only$WHYMOVE, labels = c(
"NIU",
"Change in marital status",
"To establish own household",
"Other family reason",
"New job or job transfer",
"To look for work or lost job",
"For easier commute",
"Retired",
"Other job-related reason",
"Wanted to own home, not rent",
"Wanted new or better housing",
"Wanted better neighborhood",
"For cheaper housing",
"Other housing reason",
"Attend/leave college",
"Change of climate",
"Health reasons",
"Other reasons",
"Natural disaster",
"Foreclosure or eviction",
"Relationship with unmarried partner"
))
# Create a dictionary for "State of residence 1 year ago"
state_residence_dict <- list(
`0` = "NIU",
`1` = "Alabama",
`2` = "Alaska",
`4` = "Arizona",
`5` = "Arkansas",
`6` = "California",
`8` = "Colorado",
`9` = "Connecticut",
`10` = "Delaware",
`11` = "District of Columbia",
`12` = "Florida",
`13` = "Georgia",
`15` = "Hawaii",
`16` = "Idaho",
`17` = "Illinois",
`18` = "Indiana",
`19` = "Iowa",
`20` = "Kansas",
`21` = "Kentucky",
`22` = "Louisiana",
`23` = "Maine",
`24` = "Maryland",
`25` = "Massachusetts",
`26` = "Michigan",
`27` = "Minnesota",
`28` = "Mississippi",
`29` = "Missouri",
`30` = "Montana",
`31` = "Nebraska",
`32` = "Nevada",
`33` = "New Hampshire",
`34` = "New Jersey",
`35` = "New Mexico",
`36` = "New York",
`37` = "North Carolina",
`38` = "North Dakota",
`39` = "Ohio",
`40` = "Oklahoma",
`41` = "Oregon",
`42` = "Pennsylvania",
`44` = "Rhode Island",
`45` = "South Carolina",
`46` = "South Dakota",
`47` = "Tennessee",
`48` = "Texas",
`49` = "Utah",
`50` = "Vermont",
`51` = "Virginia",
`53` = "Washington",
`54` = "West Virginia",
`55` = "Wisconsin",
`56` = "Wyoming",
`91` = "Abroad",
`99` = "Same house"
)
# Create a dictionary for "Reason for moving"
reason_for_moving_dict <- list(
`0` = "NIU",
`1` = "Change in marital status",
`2` = "To establish own household",
`3` = "Other family reason",
`4` = "New job or job transfer",
`5` = "To look for work or lost job",
`6` = "For easier commute",
`7` = "Retired",
`8` = "Other job-related reason",
`9` = "Wanted to own home, not rent",
`10` = "Wanted new or better housing",
`11` = "Wanted better neighborhood",
`12` = "For cheaper housing",
`13` = "Other housing reason",
`14` = "Attend/leave college",
`15` = "Change of climate",
`16` = "Health reasons",
`17` = "Other reasons",
`18` = "Natural disaster",
`19` = "Foreclosure or eviction",
`20` = "Relationship with unmarried partner"
)
# Replace numeric codes with labels in the dataset
data_movers_only$WHYMOVE <- reason_for_moving_dict[as.character(data_movers_only$WHYMOVE)]
data_movers_only$MIGSTA1 <- state_residence_dict[as.character(data_movers_only$MIGSTA1)]
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
# 2017-2020 and 2022
table(data_movers_only$WHYMOVE)
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason",
y = "Count")
str(data_movers_only)
# remove rows where WHYMOVE is 0
# and MIGSTA1 is not 91 or 99
# delete columns that are not WHYMOVE and MIGSTA1
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(!(MIGSTA1 == 91 | MIGSTA1 == 99)) |>
select(YEAR, WHYMOVE, MIGSTA1)
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason",
y = "Count")
str(data_movers_only)
unique(data_movers_only$MIGSTA1)
# Replace numeric codes with labels
data_movers_only <- data_movers_only |>
mutate(WHYMOVE = as_factor(recode_factor(WHYMOVE, labels(WHYMOVE))),
MIGSTA1 = as_factor(recode_factor(MIGSTA1, labels(MIGSTA1))))
data_movers_only$MIGSTA1 <- state_residence_dict[as.character(data_movers_only$MIGSTA1)]
str(data_movers_only$MIGSTA1)
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason",
y = "Count")
# plot WHYMOVE by MIGSTA1
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
facet_wrap(~MIGSTA1) +
labs(title = "Reason for Moving to Another State",
x = "Reason",
y = "Count")
glimpse(data_movers_only)
data_movers_only$MIGSTA1 <- factor(data_movers_only$MIGSTA1)
data_movers_only$MIGSTA1 <- as_factor(data_movers_only$MIGSTA1)
data_movers_only$MIGSTA1 <- as.character(data_movers_only$MIGSTA1)
glimpse(data_movers_only)
data_movers_only$MIGSTA1 <- as_factor(data_movers_only$MIGSTA1)
glimpse(data_movers_only)
# plot WHYMOVE by MIGSTA1
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
facet_wrap(~MIGSTA1) +
labs(title = "Reason for Moving to Another State",
x = "Reason",
y = "Count")
# plot WHYMOVE by MIGSTA1
ggplot(data_movers_only, aes(x = WHYMOVE)) +
geom_bar() +
facet_wrap(~MIGSTA1) +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
unique(data_movers_only$WHYMOVE)
# plot WHYMOVE by MIGSTA1
ggplot(data_movers_only, aes(x = WHYMOVE, y = MIGSTA1)) +
geom_bar() +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
# plot WHYMOVE by MIGSTA1 bar chart
ggplot(data_movers_only, aes(x = WHYMOVE, y = MIGSTA1)) +
geom_bar(stat = "identity") +
labs(title = "Reason for Moving to Another State",
x = "Reason Code",
y = "Count")
# Create a dictionary for "Reason for moving"
reason_for_moving_dict <- list(
`0` = "NIU",
`1` = "Change in marital status",
`2` = "To establish own household",
`3` = "Other family reason",
`4` = "New job or job transfer",
`5` = "To look for work or lost job",
`6` = "For easier commute",
`7` = "Retired",
`8` = "Other job-related reason",
`9` = "Wanted to own home, not rent",
`10` = "Wanted new or better housing",
`11` = "Wanted better neighborhood",
`12` = "For cheaper housing",
`13` = "Other housing reason",
`14` = "Attend/leave college",
`15` = "Change of climate",
`16` = "Health reasons",
`17` = "Other reasons",
`18` = "Natural disaster",
`19` = "Foreclosure or eviction",
`20` = "Relationship with unmarried partner"
)
# Create a dictionary for "State of residence 1 year ago"
state_residence_dict <- list(
`0` = "NIU",
`1` = "Alabama",
`2` = "Alaska",
`4` = "Arizona",
`5` = "Arkansas",
`6` = "California",
`8` = "Colorado",
`9` = "Connecticut",
`10` = "Delaware",
`11` = "District of Columbia",
`12` = "Florida",
`13` = "Georgia",
`15` = "Hawaii",
`16` = "Idaho",
`17` = "Illinois",
`18` = "Indiana",
`19` = "Iowa",
`20` = "Kansas",
`21` = "Kentucky",
`22` = "Louisiana",
`23` = "Maine",
`24` = "Maryland",
`25` = "Massachusetts",
`26` = "Michigan",
`27` = "Minnesota",
`28` = "Mississippi",
`29` = "Missouri",
`30` = "Montana",
`31` = "Nebraska",
`32` = "Nevada",
`33` = "New Hampshire",
`34` = "New Jersey",
`35` = "New Mexico",
`36` = "New York",
`37` = "North Carolina",
`38` = "North Dakota",
`39` = "Ohio",
`40` = "Oklahoma",
`41` = "Oregon",
`42` = "Pennsylvania",
`44` = "Rhode Island",
`45` = "South Carolina",
`46` = "South Dakota",
`47` = "Tennessee",
`48` = "Texas",
`49` = "Utah",
`50` = "Vermont",
`51` = "Virginia",
`53` = "Washington",
`54` = "West Virginia",
`55` = "Wisconsin",
`56` = "Wyoming",
`91` = "Abroad",
`99` = "Same house"
)
# Replace numeric codes with labels in the dataset
data_movers_only$WHYMOVE <- reason_for_moving_dict[as.character(data_movers_only$WHYMOVE)]
data_movers_only$MIGSTA1 <- state_residence_dict[as.character(data_movers_only$MIGSTA1)]
data_movers_only$MIGSTA1 <- as.character(data_movers_only$MIGSTA1)
data_movers_only$WHYMOVE <- as.character(data_movers_only$WHYMOVE)
# remove rows where WHYMOVE is 0
# and MIGSTA1 is not 91 or 99
# delete columns that are not WHYMOVE and MIGSTA1
data_movers_only <- data |>
filter(WHYMOVE != 0) |>
filter(!(MIGSTA1 == 91 | MIGSTA1 == 99)) |>
select(YEAR, WHYMOVE, MIGSTA1)
# Create a dictionary for "Reason for moving"
reason_for_moving_dict <- list(
`0` = "NIU",
`1` = "Change in marital status",
`2` = "To establish own household",
`3` = "Other family reason",
`4` = "New job or job transfer",
`5` = "To look for work or lost job",
`6` = "For easier commute",
`7` = "Retired",
`8` = "Other job-related reason",
`9` = "Wanted to own home, not rent",
`10` = "Wanted new or better housing",
`11` = "Wanted better neighborhood",
`12` = "For cheaper housing",
`13` = "Other housing reason",
`14` = "Attend/leave college",
`15` = "Change of climate",
`16` = "Health reasons",
`17` = "Other reasons",
`18` = "Natural disaster",
`19` = "Foreclosure or eviction",
`20` = "Relationship with unmarried partner"
)
# Create a dictionary for "State of residence 1 year ago"
state_residence_dict <- list(
`0` = "NIU",
`1` = "Alabama",
`2` = "Alaska",
`4` = "Arizona",
`5` = "Arkansas",
`6` = "California",
`8` = "Colorado",
`9` = "Connecticut",
`10` = "Delaware",
`11` = "District of Columbia",
`12` = "Florida",
`13` = "Georgia",
`15` = "Hawaii",
`16` = "Idaho",
`17` = "Illinois",
`18` = "Indiana",
`19` = "Iowa",
`20` = "Kansas",
`21` = "Kentucky",
`22` = "Louisiana",
`23` = "Maine",
`24` = "Maryland",
`25` = "Massachusetts",
`26` = "Michigan",
`27` = "Minnesota",
`28` = "Mississippi",
`29` = "Missouri",
`30` = "Montana",
`31` = "Nebraska",
`32` = "Nevada",
`33` = "New Hampshire",
`34` = "New Jersey",
`35` = "New Mexico",
`36` = "New York",
`37` = "North Carolina",
`38` = "North Dakota",
`39` = "Ohio",
`40` = "Oklahoma",
`41` = "Oregon",
`42` = "Pennsylvania",
`44` = "Rhode Island",
`45` = "South Carolina",
`46` = "South Dakota",
`47` = "Tennessee",
`48` = "Texas",
`49` = "Utah",
`50` = "Vermont",
`51` = "Virginia",
`53` = "Washington",
`54` = "West Virginia",
`55` = "Wisconsin",
`56` = "Wyoming",
`91` = "Abroad",
`99` = "Same house"
)
# Replace numeric codes with labels in the dataset
data_movers_only$WHYMOVE <- reason_for_moving_dict[as.character(data_movers_only$WHYMOVE)]
data_movers_only$MIGSTA1 <- state_residence_dict[as.character(data_movers_only$MIGSTA1)]
data_movers_only$MIGSTA1 <- as.character(data_movers_only$MIGSTA1)
data_movers_only$WHYMOVE <- as.character(data_movers_only$WHYMOVE)
str(data_movers_only)
glimpse(data_movers_only)
data_movers_only$year <- as.factor(data_movers_only$YEAR)
glimpse(data_movers_only)
data_movers_only$year <- NULL
glimpse(data_movers_only)
data_movers_only$YEAR <- as.character(data_movers_only$YEAR)
glimpse(data_movers_only)
write_csv(data, "../raw data/moving_reason_by_state_raw.csv")
# export csv file
write_csv(data, "../raw data/moving_reason_by_state_raw.csv")
# export csv file
write_csv(data, "./raw data/moving_reason_by_state_raw.csv")
write_csv(data_movers_only, "./cleansed data/moving_reason_by_state.csv")
